[TOP](../README.md)   
前: [マージ時の競合解決](./conflict.md)  
次: [.gitignoreと.gitkeep](./ignore-keep.md)  

---

# 3. 特定シチュエーションでの操作
## 3-4. コミットの取消・打消
コミットの取消と打消について取り上げます。コミットの取消とは、対象コミット自体を無かったことにしコミット履歴を前の状態に戻すことを指します。コミットの打消とは、対象コミットの変更内容を元に戻すコミットを作成することを指します。この場合コミット履歴には変更を元に戻すコミットが追加され、対象コミットはそのまま残ります。  
`git reset`を使うことでコミットを取り消すことができます。このコマンドはオプションによって、コミットのみ取消、コミットおよびインデックスの取消、コミット・インデックス・手元ファイルの変更の取消と挙動が変わります。現在の状況に適したオプションを使うようにしましょう。なおリモートブランチにプッシュ済みの内容に対して`git reset`を使っても、プッシュ時にエラーになります。その場合はコミットの取消ではなく打消を行いましょう。  
`git revert`を使うことでコミットを打ち消すことができます。

1. 任意のディレクトリで`ターゲットリポジトリのクローンURL`を使いクローンしてください。
2. ローカルブランチ「3-4」を新しく作成し、切り替えてください。
3. 現在のブランチを確認します。以下のようにブランチ「3-4」が選択されていることを確認してください。（他のブランチがリストされていても構いません）
```
* 3-4
master
```
4. ファイル「3-4.txt」を新しく作成し、コミットしてください。（コミットのコメントは何でも構いません）
5. コミットの履歴を確認してください。
6. 直前のコミットのみ取り消してください。（ヒント：`--soft`オプションを使い、対象コミットは`HEAD^`を指定します）
7. コミットの履歴を確認し、直前のコミットが取り消されているのを確認してください。
8. コミットしてください。（ヒント：インデックスの状態はそのままなので、コミットするだけで構いません）
9. 直前のコミット・インデックス・手元ファイルの変更を取り消してください。（ヒント：`--hard`オプションを使い、対象コミットは`HEAD^`を指定します）
10. コミットの履歴・インデックスの状態・手元ファイルをそれぞれ確認し、直前のコミットに関わる部分が取り消されているのを確認してください。
11. ファイル「3-4.txt」を再度作成し、コミットしてください。（コミットのコメントは何でも構いません）
12. 直前のコミットを打ち消してください。コマンド実行後コミットのコメント編集画面を閉じる（:wqで閉じられます）と処理が実行されます。（ヒント：対象コミットは`HEAD`を指定します）
13. コミットの履歴を確認し、直前のコミットが残っていることおよび変更を元に戻すコミットが追加されていることを確認してください。以下のようなコミットが追加されています。
```
commit 5a9c719ce7fa20155f30a5a804c334b1a8830902 (HEAD -> 3-4)
Author: narita <narita.ryo@xxxx.xx.xx>
Date:   Wed Dec 9 00:49:35 2020 +0000

Revert "add file"
    
This reverts commit 07014855a7559d1959ac2b0f84d03a7ca6c48eae.

commit 07014855a7559d1959ac2b0f84d03a7ca6c48eae
Author: narita <narita.ryo@xxxx.xx.xx>
Date:   Wed Dec 9 00:47:33 2020 +0000

add file
```
14.  masterブランチに切り替え、ローカルブランチ「3-4」を削除してください。

--- 

[TOP](../README.md)   
前: [マージ時の競合解決](./conflict.md)  
次: [.gitignoreと.gitkeep](./ignore-keep.md)  